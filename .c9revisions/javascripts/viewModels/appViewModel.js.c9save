{"ts":1375454795006,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"// Main viewmodel class\r\ndefine(['../../lib/knockout-2.3.0', '../../lib/jquery-1.10.2.min'], function(ko) {\r\n    function appViewModel() {\r\n        var self = this;\r\n        \r\n        self.grossIncome = ko.observable(0);\r\n        self._401k = ko.observable(0);\r\n        self.roth = ko.observable(0);\r\n        self.afterTax = ko.observable(0);\r\n        self.principal = ko.observable(0);\r\n        self.returnRate = ko.observable(0.07);\r\n        self.safeWithdrawalRate = ko.observable(.04);\r\n        \r\n        self.taxRate = ko.computed(function() {\r\n            return 0.15;\r\n        });\r\n        \r\n        self.netIncome = ko.computed(function() {\r\n            return Round( self.grossIncome() - self._401k() ) * ( 1 - self.taxRate() );\r\n        });\r\n        \r\n        self.yearlySpend = ko.computed(function() {\r\n            return Round(self.netIncome() - self.roth() - self.afterTax());\r\n        });\r\n        \r\n        self.monthlySpend = ko.computed(function() {\r\n            return Round(self.yearlySpend() / 12);\r\n        });\r\n        \r\n        self.weeklySpend = ko.computed(function() {\r\n            return Round(self.monthlySpend() / 4);\r\n        });\r\n        \r\n        self.dailySpend = ko.computed(function() {\r\n            return Round(self.monthlySpend() / 30.4);\r\n        });\r\n        \r\n        self.yearlyInvestment = ko.computed(function() {\r\n            return Round(+self._401k() + +self.roth() + +self.afterTax());\r\n        });\r\n        \r\n        // Returns the value of the retirement accounts for years 0-100.\r\n        self.retirementAccountSeries = ko.computed(function() {\r\n            var series = [];\r\n            self.yearlyInvestment();\r\n            for (var i = 0; i<100; i++) {\r\n                series.push(valueAfterYears(i))\r\n            };\r\n            return series;\r\n        });\r\n        \r\n        // Returns the number of years until user is able to retire.\r\n        self.yearsTillIndependent = ko.computed(function() {\r\n            var retirementYear = 100;\r\n            $.each(self.retirementAccountSeries(), function(index, value) {\r\n                if (value * self.safeWithdrawalRate() > self.yearlySpend()) {\r\n                    retirementYear = index;\r\n                    return false; // escapes the .each() loop.\r\n                }\r\n            });\r\n            return retirementYear;\r\n        });\r\n        \r\n        //  Returns the value of the retirement accounts after a specified number of years.\r\n        function valueAfterYears(years) {\r\n            var p = +self.principal();\r\n            var r = +self.returnRate();\r\n            var z = 1+r;\r\n            var c = +self.yearlyInvestment();\r\n            \r\n            return (p * Math.pow(z, years)) + c * ( (Math.pow(z, (years+1)) - z) / r);\r\n            \r\n            // Math for this method found at http://www.moneychimp.com/articles/finworks/fmbasinv.htm\r\n        }\r\n        \r\n        function Round(number) {\r\n            return Math.round(number * 100) / 100;\r\n        }\r\n    }\r\n    \r\n    ko.applyBindings(new appViewModel());\r\n});\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"]],"start1":0,"start2":0,"length1":0,"length2":3088}]],"length":3088}
{"contributors":[],"silentsave":false,"ts":1375454813190,"patch":[[{"diffs":[[0,"-2.3.0',"],[1," '../../lib/jquery-1.10.2.min',"],[0," '../../"]],"start1":52,"start2":52,"length1":16,"length2":47}]],"length":3119,"saved":false}
{"ts":1375454828735,"patch":[[{"diffs":[[0," '../../lib/"],[-1,"jquery-1.10.2"],[1,"koExternalTemplateEngine_all"],[0,".min'], func"]],"start1":91,"start2":91,"length1":37,"length2":52}]],"length":3134,"saved":false}
{"ts":1375454905472,"patch":[[{"diffs":[[0,"min'"],[-1,", '../../lib/koExternalTemplateEngine_all.min'"],[0,"], f"]],"start1":86,"start2":86,"length1":54,"length2":8}]],"length":3088,"saved":false}
{"ts":1375455344554,"patch":[[{"diffs":[[0,"efine(['"],[-1,"../../"],[0,"lib/knoc"]],"start1":26,"start2":26,"length1":22,"length2":16}]],"length":3082,"saved":false}
{"ts":1375455347626,"patch":[[{"diffs":[[0,"', '"],[-1,"../../"],[0,"lib/"]],"start1":52,"start2":52,"length1":14,"length2":8}]],"length":3076,"saved":false}
{"contributors":[],"silentsave":false,"ts":1375455449932,"patch":[[{"diffs":[[0,"kout"],[-1,"-2.3.0"],[0,"', '"]],"start1":42,"start2":42,"length1":14,"length2":8},{"diffs":[[0,"uery"],[-1,"-1.10.2.min"],[0,"'], "]],"start1":56,"start2":56,"length1":19,"length2":8}]],"length":3059,"saved":false}
{"ts":1375456020247,"patch":[[{"diffs":[[0,"/jquery'"],[1,", 'lib/koExternalTemplateEngine'"],[0,"], funct"]],"start1":53,"start2":53,"length1":16,"length2":48}]],"length":3091,"saved":false}
{"ts":1375456024830,"patch":[[{"diffs":[[0,"teEngine"],[1,"_all.min"],[0,"'], func"]],"start1":84,"start2":84,"length1":16,"length2":24}]],"length":3099,"saved":false}
